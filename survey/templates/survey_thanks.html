{% extends 'base.html' %}
{% load i18n %}

{% block content %}
{% if thanks_html %}
    {{ thanks_html|safe }}
{% else %}
<div class="text-center mt-5">
    <h2>{% trans "Thank you!" %}</h2>
    <p>{% trans "Your responses have been recorded." %}</p>
</div>
{% endif %}

<div class="text-center mt-4">
    <button id="share-btn" class="btn btn-outline-primary">
        <i class="fas fa-share-alt me-2"></i><span id="share-text"></span>
    </button>
    <span id="share-copied" class="text-success ms-2" style="display:none;"></span>
</div>

<script>
(function() {
    var lang = '{{ lang }}';
    var i18n = {
        share: { ru: 'Поделиться опросом', ky: 'Сурамжылоону бөлүшүү', en: 'Share this survey' },
        copied: { ru: 'Ссылка скопирована!', ky: 'Шилтеме көчүрүлдү!', en: 'Link copied!' }
    };
    function t(key) { return i18n[key][lang] || i18n[key]['en']; }

    var btn = document.getElementById('share-btn');
    var copied = document.getElementById('share-copied');
    document.getElementById('share-text').textContent = t('share');
    copied.textContent = t('copied');

    var url = window.location.origin + '{% url "survey" survey_name %}';

    btn.addEventListener('click', function() {
        if (navigator.share) {
            navigator.share({ url: url }).catch(function() {});
        } else {
            navigator.clipboard.writeText(url).then(function() {
                copied.style.display = 'inline';
                setTimeout(function() { copied.style.display = 'none'; }, 2000);
            });
        }
    });
})();
</script>
{% endblock %}
